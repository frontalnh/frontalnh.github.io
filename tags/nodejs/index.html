<!DOCTYPE html>
<html class="has-navbar-fixed-top">

<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
<title>Tag: nodejs - Jake.Lee&#39;s Blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="google-site-verification" content="PgpnJMuvO-IqYWyFljnyr-tusLhJUz1VRMmECenJyHE">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">






<link rel="icon" href="/favicon.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="/css/style.css">
<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>

</head>

<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                <img src="/images/logo.png" alt="" height="28">
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item " href="/archives">Archives</a>
            
            <a class="navbar-item " href="/categories">Categories</a>
            
            <a class="navbar-item " href="/tags">Tags</a>
            
            <a class="navbar-item " href="/about">About</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            
            <a class="navbar-item" href="https://github.com/frontalnh">
                
                <i class="fab fa-github"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

        <section class="section section-heading">
    <div class="container">
        <div class="content">
            <h5>#nodejs</h5>
        </div>
    </div>
</section>
<section class="section">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6354931397950820",
    enable_page_level_ads: true
  });
</script>

    <div class="container">
    
        <article class="article content gallery" itemscope="" itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2019/03/28/setup-nodejs-in-ubuntu/" itemprop="url">
                Setup Nodejs in ubuntu
            </a>
            
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2019-03-28T02:14:34.000Z" itemprop="datePublished">
                3 months ago
            </time>
        </span>
        
            <span class="column is-narrow article-category">
                <i class="far fa-folder"></i>
                <a class="article-category-link" href="/categories/ubuntu/">ubuntu</a><span>></span><a class="article-category-link" href="/categories/ubuntu/nodejs/">nodejs</a>
            </span>
            
                
                    <span class="column is-narrow">
                        
                            
                                a few seconds read (About 8 words)
                    </span>
                    
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
        
                    <h2><span id="setup">Setup</span></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install build-essential</span><br></pre></td></tr></table></figure>

                        
    </div>
    
            
</article>



        
    
        <article class="article content gallery" itemscope="" itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2019/03/22/building-node-api-server-based-on-ddd-architecture/" itemprop="url">
                Building node API server based on DDD architecture
            </a>
            
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2019-03-22T07:02:12.000Z" itemprop="datePublished">
                3 months ago
            </time>
        </span>
        
            <span class="column is-narrow article-category">
                <i class="far fa-folder"></i>
                <a class="article-category-link" href="/categories/nodejs/">nodejs</a>
            </span>
            
                
                    <span class="column is-narrow">
                        
                            
                                7 minutes read (About 992 words)
                    </span>
                    
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
        
                    <h1><span id="building-node-api-server-based-on-ddd-architecture">Building node API server based on DDD architecture</span></h1><h2><span id="domain-layer">Domain Layer</span></h2><p>Domain 레이어는 각 서브 도메인 마다 model, service, repository를 가지며 다음과 같은 역할을 수행한다.</p>
<p>-   Model</p>
<p>​    해당 도메인의 모델링이 정의되고, 해당 도메인 내에서의 항상성과 유효성을 담당한다.</p>
<p>-   Service</p>
<p>​    주로 여러 도메인을 아우르는 로직을 처리한다.</p>
<p>-   Repository</p>
<p>​    도메인 단위로 DB 입출력을 담당하며, 실제 구현은 infra layer의 repository implementation에서 이루어 지며, interface만 정의되어 있다.</p>
<h2><span id="api-layer">API Layer</span></h2><p>도메인의 서비스들을 조합하며 엔드 유저 레벨에서의 기능수행이 이루어 진다.</p>
<p>가령 특정 재화를 구매함에 따라 결제를 수행하는 어플리케이션이 있다면 본 api 레이어에는 ‘결제’와 같은 엔드 유저 레벨에서의 함수가 들어가며, 결제 데이터 생성, 구매자의 감소 등과 같은 로직은 도메인의 모델 및 서비스 레벨에서 처리된다.</p>
<h2><span id="infra-layer">Infra layer</span></h2><p>도메인의 비즈니스 로직들이 잘 수행될 수 있도록 DB, http 라우터 등 외부 환경을 다루는 실제 구현이 이루어 진다.</p>
<p>본 레이어에서 도메인의 repository interface에 정의된 함수들을 실제로 구현하며, express router를 활용하여 외부 요청에 대한 라우팅을 수행한다.</p>
<p>또한 본 레이어에는 middleware, auth guard, errorHandler 처럼 도메인에 접근하기 전에 전처리되거나 비즈니스 로직 이후 클라이언트에게 반환할 반환값에 대한 후처리 로직이 들어간다.</p>
<p>auth guard 는 decorator 를 사용하여 제작되었다.</p>
<h2><span id="branching-model">Branching Model</span></h2><p>모든 작업 내용은 feature/[브랜치 명] 에서 작업하고, dev 서버에 배포하기 위한 버전을 develop 브랜치에 푸시한다.</p>
<p>Release 브랜치에서 develop 브랜치를 pull 하면서 코드리뷰를 진행하고 모든 코드리뷰 사항이 반영되면 release 브랜치에 머지된다.</p>
<p>release 브랜치에서 스프린트 및 일정관리, 테스트 작업을 진행하며 안정화되면 master 브랜치로 push 하고 서비스 배포한다.</p>
<p>-   Master: 실제 서비스 배포를 위한 브랜치</p>
<p>-   Release: 개발 진행의 경과가 되는 브랜치로 QA 및 일정관리의 지표가 된다.</p>
<p>-   Develop: 각 개발자들이 실시간으로 머지하는 브랜치로 테스트 서버의 소스코드가 보관된다.</p>
<p>-   Feature: 각 개발자들이 임의로 자신들의 작업량을 작업한다.</p>
<h2><span id="input-validation">Input validation</span></h2><p>본 프로젝트에서는 클라이언트의 요청값을 검증함에 있어 모든 요청의 형태를 DTO 형태로 정의하고 해당 DTO 에 값을 넣기 전에 <code>Joi</code> 라이브러리를 사용하여 요청값에 대한 검증을 수행한다.</p>
<h2><span id="tsconfig-setting">tsconfig setting</span></h2><p>각 파일에서 다른 파일을 import 함에 있어서 보다 가독성을 높이기 위해 @domain과 같이 태그를 하여 손쉽게 import를 할 수 있습니다.</p>
<p>tsconfig.json 파일의 예</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line"></span><br><span class="line">        <span class="attr">"paths"</span>: &#123;</span><br><span class="line"></span><br><span class="line">            <span class="attr">"@domain/"</span>: [<span class="string">"server/domain/"</span>]</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>위처럼 옵션을 설정하면 복잡한 filepath 대신 위의 태그네임을 통해 import 할 수 있습니다.</p>
<p>이때 위의 태그네임이 잘 반영이 되지 않는 경우가 있는데, 이는 웹팩에서 트랜스파일링을 하는 과정에서 webpack.config.js 세팅을 바꾸어 줌으로써 해결이 가능합니다.</p>
<p>태그 네이밍을 하기 위해서 tsconfig-paths-webpack-plugin 을 사용하는데 해당 플러그인은 다음과 같이</p>
<p>루트 plugin이 아닌 resolve 내의 plugin 내에 설정되어야 합니다.</p>
<p>webpack.config.js의 예</p>
<p>\<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">​    resolve: &#123;</span><br><span class="line"></span><br><span class="line">​        plugins: [</span><br><span class="line"></span><br><span class="line">​            <span class="keyword">new</span> TsconfigPathsPlugin(&#123;</span><br><span class="line"></span><br><span class="line">​                configFile: <span class="string">'./tsconfig.json'</span> <span class="comment">// setup tsconfig path</span></span><br><span class="line"></span><br><span class="line">​            &#125;)</span><br><span class="line"></span><br><span class="line">​        ];</span><br><span class="line"></span><br><span class="line">​    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">\</span><br></pre></td></tr></table></figure></p>
<h3><span id="author">Author</span></h3><p><a href="https://github.com/frontalnh" target="_blank" rel="noopener">frontalnh(Namhoon Lee)</a></p>

                        
    </div>
    
            
</article>



        
    
        <article class="article content gallery" itemscope="" itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2018/07/31/nodejs-sequelize-사용하기/" itemprop="url">
                nodejs sequelize 사용하기
            </a>
            
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2018-07-31T04:43:19.000Z" itemprop="datePublished">
                10 months ago
            </time>
        </span>
        
            <span class="column is-narrow article-category">
                <i class="far fa-folder"></i>
                <a class="article-category-link" href="/categories/nodejs/">nodejs</a>
            </span>
            
                
                    <span class="column is-narrow">
                        
                            
                                a minute read (About 135 words)
                    </span>
                    
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
        
                    <h1><span id="nodejs-에서-sequelize-사용하기">nodejs 에서 sequelize 사용하기</span></h1><p>sequelize 에서 객체를 기반으로 데이터 입출력을 하기 위해 model을 정의한다.</p>
<h2><span id="설치하기">설치하기</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -- save sequelize</span><br></pre></td></tr></table></figure>
<h2><span id="connection-연결하기">Connection 연결하기</span></h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Sequelize = <span class="built_in">require</span>(<span class="string">'sequelize'</span>);</span><br><span class="line"><span class="keyword">const</span> sequelize = <span class="keyword">new</span> Sequelize(<span class="string">'database'</span>, <span class="string">'username'</span>, <span class="string">'password'</span>, &#123;</span><br><span class="line">  host: <span class="string">'localhost'</span>,</span><br><span class="line">  dialect: <span class="string">'mysql'</span>|<span class="string">'sqlite'</span>|<span class="string">'postgres'</span>|<span class="string">'mssql'</span>,</span><br><span class="line">  operatorsAliases: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  pool: &#123;</span><br><span class="line">    max: <span class="number">5</span>,</span><br><span class="line">    min: <span class="number">0</span>,</span><br><span class="line">    acquire: <span class="number">30000</span>,</span><br><span class="line">    idle: <span class="number">10000</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQLite only</span></span><br><span class="line"><span class="comment">//   storage: 'path/to/database.sqlite'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2><span id="모델-정의하기">모델 정의하기</span></h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> User = sequelize.define(<span class="string">'user'</span>, &#123;</span><br><span class="line">  firstName: &#123;</span><br><span class="line">    type: Sequelize.STRING</span><br><span class="line">  &#125;,</span><br><span class="line">  lastName: &#123;</span><br><span class="line">    type: Sequelize.STRING</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// force: true will drop the table if it already exists</span></span><br><span class="line">User.sync(&#123;<span class="attr">force</span>: <span class="literal">true</span>&#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Table created</span></span><br><span class="line">  <span class="keyword">return</span> User.create(&#123;</span><br><span class="line">    firstName: <span class="string">'John'</span>,</span><br><span class="line">    lastName: <span class="string">'Hancock'</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2><span id="query">query</span></h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">User.findAll().then(<span class="function"><span class="params">users</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(users)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
                        
    </div>
    
            
</article>



        
    
        <article class="article content gallery" itemscope="" itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2018/03/18/express의-기본-개념/" itemprop="url">
                express 시작하기
            </a>
            
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2018-03-17T15:36:53.000Z" itemprop="datePublished">
                a year ago
            </time>
        </span>
        
            <span class="column is-narrow article-category">
                <i class="far fa-folder"></i>
                <a class="article-category-link" href="/categories/nodejs-강의/">nodejs 강의</a>
            </span>
            
                
                    <span class="column is-narrow">
                        
                            
                                a few seconds read (About 64 words)
                    </span>
                    
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
        
                    <h1><span id="express란">Express란?</span></h1><p>Express는 자체적인 최소한의 기능을 갖춘 라우팅 및 미들웨어 웹 프레임워크이며, Express 애플리케이션은 기본적으로 일련의 미들웨어 함수 호출이다.</p>
<h2><span id="installation">Installation</span></h2><p><code>npm install express --save</code></p>

                        
    </div>
    
            
</article>



        
    
        <article class="article content gallery" itemscope="" itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2018/02/01/nodejs-페이스북-회원가입/" itemprop="url">
                nodejs 페이스북 회원가입
            </a>
            
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2018-02-01T09:28:12.000Z" itemprop="datePublished">
                a year ago
            </time>
        </span>
        
                
                    <span class="column is-narrow">
                        
                            
                                7 minutes read (About 1033 words)
                    </span>
                    
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
        
                    <h2><span id="개요">개요</span></h2><p>클라이언트에서 웹페이지의 버튼 클릭 등으로 이미 구축해 놓은 server의 url에 페이스북 토큰과 함께 로그인 요청을 보내면, 서버는 passport 모듈을 통해 받은 토큰을 facebook에 보내어 인증을 거치고 페이스북에서 거친 인증값을 담아 서버의 callback 라우터에 요청을 보낸다.<br>서버는 요청을 받고 accessToken을 저장하며 accessToken과 유저정보들을 jwt 암호화를 거쳐 jwt를 발급하여 클라이언트에게 다시 보내어 준다.<br>클라이언트는 받은 jwt를 localStorage에 저장하고 앞으로 자동 로그인시에 해당 jwt 토큰을 사용한다.</p>
<h2><span id="passport-설치">passport 설치</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --save passport</span><br><span class="line">npm install --save passport-facebook</span><br></pre></td></tr></table></figure>
<h2><span id="모듈-import-하기">모듈 import 하기</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var NaverStrategy = require(&apos;passport-naver&apos;).Strategy;</span><br><span class="line">var FacebookStrategy = require(&apos;passport-facebook&apos;).Strategy;</span><br><span class="line">var KakaoStrategy = require(&apos;passport-kakao&apos;).Strategy;</span><br></pre></td></tr></table></figure>
<p>필요한 모듈을 import 해준다.</p>
<h2><span id="개발자-정보를-비롯한-기밀-정보들-별도-파일에-저장">개발자 정보를 비롯한 기밀 정보들 별도 파일에 저장</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  &apos;secret&apos; :  &apos;&apos;,</span><br><span class="line">  &apos;db_info&apos;: &#123;</span><br><span class="line">    local: &#123; // localhost</span><br><span class="line">    ...</span><br><span class="line">    &#125;,</span><br><span class="line">    real: &#123; // real</span><br><span class="line">    ...</span><br><span class="line">    &#125;,</span><br><span class="line">    dev: &#123; // dev</span><br><span class="line">    ...</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &apos;federation&apos; : &#123;</span><br><span class="line">    &apos;naver&apos; : &#123;</span><br><span class="line">      &apos;client_id&apos; : &apos;&apos;,</span><br><span class="line">      &apos;secret_id&apos; : &apos;&apos;,</span><br><span class="line">      &apos;callback_url&apos; : &apos;/auth/login/naver/callback&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    &apos;facebook&apos; : &#123;</span><br><span class="line">      &apos;client_id&apos; : &apos;&apos;,</span><br><span class="line">      &apos;secret_id&apos; : &apos;&apos;,</span><br><span class="line">      &apos;callback_url&apos; : &apos;/auth/login/facebook/callback&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    &apos;kakao&apos; : &#123;</span><br><span class="line">      &apos;client_id&apos; : &apos;&apos;,</span><br><span class="line">      &apos;callback_url&apos; : &apos;/auth/login/kakao/callback&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>federation 객체에 네이버, 카카오, 페이스북 Developers 정보를 입력한다.<br>secret.js 민감한 정보를 갖고있는 파일들은 프로젝트 디렉토리에 포함시키지 않는 것이 바람직하다.</p>
<h2><span id="서버코드-작성">서버코드 작성</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">var secret_config = require(&apos;../commons/secret&apos;);</span><br><span class="line">  var secret_config = require(&apos;../_commons/secret&apos;);</span><br><span class="line">  var FacebookStrategy = require(&apos;passport-facebook&apos;).Strategy;</span><br><span class="line">  passport.serializeUser(function(user, done) &#123;</span><br><span class="line">    done(null, user);</span><br><span class="line">  &#125;);</span><br><span class="line">  passport.deserializeUser(function(user, done) &#123;</span><br><span class="line">    done(null, user);</span><br><span class="line">  &#125;);</span><br><span class="line">  passport.use(new FacebookStrategy(&#123;</span><br><span class="line">      clientID: secret_config.federation.facebook.client_id,</span><br><span class="line">      clientSecret: secret_config.federation.facebook.secret_id,</span><br><span class="line">      callbackURL: secret_config.federation.facebook.callback_url,</span><br><span class="line">      profileFields: [&apos;id&apos;, &apos;emails&apos;, &apos;name&apos;] //This</span><br><span class="line">    &#125;,</span><br><span class="line">    function (accessToken, refreshToken, profile, done)&#123;</span><br><span class="line">      console.log(&quot;profile&quot;, profile);</span><br><span class="line">      console.log(&quot;accessToken:&quot;, accessToken);</span><br><span class="line">      var _profile = profile._json;</span><br><span class="line">      loginByThirdparty(&#123;</span><br><span class="line">        &apos;auth_type&apos;: &apos;facebook&apos;,</span><br><span class="line">        &apos;auth_id&apos;: _profile.id,</span><br><span class="line">        &apos;auth_name&apos;: _profile.first_name+&quot; &quot;+_profile.last_name,</span><br><span class="line">        &apos;auth_email&apos;: _profile.email,</span><br><span class="line">        &apos;auth_token&apos;: accessToken</span><br><span class="line">      &#125;, done);</span><br><span class="line">    &#125;</span><br><span class="line">  ));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  router.get(&apos;/facebook&apos;,</span><br><span class="line">    passport.authenticate(&apos;facebook&apos;,&#123;authType: &apos;rerequest&apos;, scope: [&apos;public_profile&apos;, &apos;email&apos;]&#125;)</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  // facebook 로그인 연동 콜백</span><br><span class="line">  router.get(&apos;/facebook/callback&apos;, passport.authenticate(&apos;facebook&apos;,&#123;failureRedirect: &apos;/login/null/null&apos;&#125;),function(req,res)&#123;</span><br><span class="line">    console.log(&quot;REQ&quot;,req);</span><br><span class="line">    console.log(&quot;RES&quot;,res);</span><br><span class="line">        res.redirect(&apos;http://localhost/login/&apos;+req.user.email+&quot;/&quot;+req.user.jwt)</span><br><span class="line">      &#125;</span><br><span class="line">  );</span><br></pre></td></tr></table></figure>
<p>passport.use를 통해 OAuth 요청을 만들어서 네이버 로그인 처리를 진행하고 요청결과를 callback url로 라우팅 시켜줌을 설정한다.<br>먼저 auth/login/facebook으로 요청이 오면 페이스북으로 로그인 요청을 보내고 결과값을 callback url로 보내준다.<br>callback url을 처리하는 라우터는 로그인이 성공할 경우 인덱스 페이지로 리다이렉트 시켜주고 실패할 경우에는 다시 로그인 페이지로 리다이렉트 시켜준다.<br>앵귤러의 경우 특정 페이지에 리다이렉트 되면 컴포넌트가 생성되는 시점에서 query의 뒷부분에 붙은 email 과 jwt를 가지고 jwt는 저장하고 email로 유저의 정보를 받아와 클라이언트에서 사용한다.</p>
<p>/auth/facebook/callback은 페이스북이 검증을 마치고 난 결과를 전송해주는 주소이다.</p>
<h2><span id="서버의-로그인-함수-작성">서버의 로그인 함수 작성</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">function loginByThirdparty(info, done) &#123;</span><br><span class="line">  console.log(&apos;process : &apos; + info.auth_type);</span><br><span class="line">  var stmt_duplicated = &apos;select *from `user` where `user_id` = ?&apos;;</span><br><span class="line">  connection.query(stmt_duplicated, info.auth_id, function (err, result) &#123;</span><br><span class="line">    if (err) &#123;</span><br><span class="line">      return done(err);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      if (result.length === 0) &#123;</span><br><span class="line">        // 신규 유저는 회원 가입 이후 로그인 처리</span><br><span class="line">        var stmt_thridparty_signup = &apos;insert into `user` set `user_id`= ?, `nickname`= ?&apos;;</span><br><span class="line">        connection.query(stmt_thridparty_signup, [info.auth_id, info.auth_name], function (err, result) &#123;</span><br><span class="line">          if(err)&#123;</span><br><span class="line">            return done(err);</span><br><span class="line">          &#125;else&#123;</span><br><span class="line">            done(null, &#123;</span><br><span class="line">              &apos;user_id&apos;: info.auth_id,</span><br><span class="line">              &apos;nickname&apos;: info.auth_name</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        //기존유저 로그인 처리</span><br><span class="line">        console.log(&apos;Old User&apos;);</span><br><span class="line">        done(null, &#123;</span><br><span class="line">          &apos;user_id&apos;: result[0].user_id,</span><br><span class="line">          &apos;nickname&apos;: result[0].nickname</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>auth.id 기반으로 신규 회원인지 기존 회원인지 판단한다.<br>신규 회원일 경우에는 user 테이블에 회원 정보를 저장 시키고 로그인 처리를 진행하고, 기존 유저일 경우에는 쿼리로 조회한 회원정보를 기반으로 로그인 처리를 진행합니다.<br>간단하게 말씀드리면 신규회원이든 기존 회원이든 원클릭으로 회원 가입 절차를 진행하게 할 수 있습니다.</p>

                        
    </div>
    
            
</article>



        
    
        <article class="article content gallery" itemscope="" itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2018/01/22/Building a node.js app with typescript/" itemprop="url">
                Building a node.js app with typescript
            </a>
            
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2018-01-22T02:21:57.000Z" itemprop="datePublished">
                a year ago
            </time>
        </span>
        
            <span class="column is-narrow article-category">
                <i class="far fa-folder"></i>
                <a class="article-category-link" href="/categories/nodejs-강의/">nodejs 강의</a>
            </span>
            
                
                    <span class="column is-narrow">
                        
                            
                                8 minutes read (About 1188 words)
                    </span>
                    
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
        
                    <!--toc-->
<h2><span id="개요">개요</span></h2><p>In this post, you will learn how to deploy a node.js server in a typescript environment.</p>
<p>기본적인 서버 및 데이터베이스의 구축에서 부터 실제 배포 및 개발환경 세팅에 이르는 실제 운영을 위한 여러 고려사항들을 검토하고 논의하며 <code>ubuntu</code> 운영체제를 기본 환경으로 사용한다.</p>
<h2><span id="installation">Installation</span></h2><p>At first, install node.js web server</p>
<p>먼저 홈페이지에 들어가서 노드js를 설치한다.<br><a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">nodejs 홈페이지</a></p>
<p>nodejs를 설치했다면 apt-get의 로컬 패키지를 업데이트 해준다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure></p>
<p>리눅스계열 os의 경우 다음 code로 설치한다.<br>npm의 경우 원래는 nodejs 안에 포함되어 같이 깔리지만 커맨드가 안잡힌다면 아래 별도 명령어를 통해 다시 설치해 준다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y nodejs</span><br><span class="line">sudo apt-get npm</span><br></pre></td></tr></table></figure>
<p>cmd에서 node –version으로 설치가 잘 되었는지 확인하고 npm을 통해 다양한 모듈을 세팅한다.<br>만약 aws 서버의 경우 보안 문제 때문에 제대로 설치가 되지 않을 수 있다.<br>그럴때는 –unsafe-perm 을 붙여 설치를 진행해 본다.<br>대부분의 문제가 해결될 것이다.</p>
<p>npm의 버전이 맞지 않아 패키지 설치에 문제가 있는 경우 npm을 최신버전으로 업데이트 해야 한다.<br>하지만, npm을 업데이트 하기 전에 그에 상응하는 최신 nodejs를 설치해 주기 위해 nodejs 버전관리 모듈인 n을 설치해 주고 새로운 nodejs를 설치해 준다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install n -g</span><br><span class="line">sudo n stable</span><br></pre></td></tr></table></figure></p>
<p>설치가 완료된 뒤에 다음 명령어를 입력하여 제대로 버전이 바뀌었는지를 확인한다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br></pre></td></tr></table></figure></p>
<p>여기서 버전이 제대로 업데이트 되지 않았다면 다음과 같이 수동으로 입력해 준다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -sf /usr/local/n/versions/node/6.0.0/bin/node /usr/bin/node</span><br></pre></td></tr></table></figure></p>
<p>npm을 최신으로 업데이트 해 준다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install npm@latest -g</span><br></pre></td></tr></table></figure></p>
<p>shell을 재실행 시킨 뒤 npm의 버전이 변경되었는지 확인한다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm -v</span><br></pre></td></tr></table></figure></p>
<h3><span id="compile-typescript">Compile Typescript</span></h3><p>typescript 컴파일러인 tsc 를 통해 다음과 같이 컴파일 할 수 있다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsc</span><br></pre></td></tr></table></figure>
<p>typescript compile 할 때에 필요한 다양한 옵션을 tsconfig.json 파일에 명실 할 수 있다. 필자의 경우는 file import 시에 다음과 같이 alias 를 사용하였기 때문에 해당 alias 의 위치를 tsc 가 찾을 수 있도록 <code>tsconfig.json 에 paths를 등록</code>해 준다.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="attr">"target"</span>: <span class="string">"es6"</span>,</span><br><span class="line">    <span class="attr">"module"</span>: <span class="string">"commonjs"</span>,</span><br><span class="line">    <span class="attr">"sourceMap"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"allowSyntheticDefaultImports"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"allowJs"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"outDir"</span>: <span class="string">"./dist/"</span>,</span><br><span class="line">    <span class="attr">"noImplicitAny"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"lib"</span>: [<span class="string">"es2015"</span>],</span><br><span class="line">    <span class="attr">"esModuleInterop"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"experimentalDecorators"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"emitDecoratorMetadata"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"baseUrl"</span>: <span class="string">"./src"</span>,</span><br><span class="line">    <span class="attr">"paths"</span>: &#123;</span><br><span class="line">      <span class="attr">"@domain/*"</span>: [<span class="string">"server/domain/*"</span>],</span><br><span class="line">      <span class="attr">"@common/*"</span>: [<span class="string">"server/common/*"</span>],</span><br><span class="line">      <span class="attr">"@utils/*"</span>: [<span class="string">"server/utils/*"</span>],</span><br><span class="line">      <span class="attr">"@infra/*"</span>: [<span class="string">"server/infra/*"</span>],</span><br><span class="line">      <span class="attr">"@api/*"</span>: [<span class="string">"server/api/*"</span>],</span><br><span class="line">      <span class="attr">"@interfaces/*"</span>: [<span class="string">"server/interfaces/*"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"include"</span>: [<span class="string">"./src/**/*"</span>],</span><br><span class="line">  <span class="attr">"exclude"</span>: [<span class="string">"node_modules"</span>, <span class="string">"**/*.spec.ts"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이처럼 path의 경우 단지 컴파일러에게 해당 파일이 어디에 있는지에 대한 위치정보만을 가르쳐줄 뿐이며, 이는 컴파일되어도 alias의 값이 그대로 들어가게 된다.</p>
<p>이러한 module-alias 를 실행하기 위해서는 다음과 같이 module-alias 를 설치하고 메인 파일에서 이를 등록해 주어야 한다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save module-alias</span><br></pre></td></tr></table></figure>
<p>index.ts</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">require(&apos;module-alias/register&apos;);</span><br></pre></td></tr></table></figure>
<p>이러한 alias의 위치를 실행시점에서 지정해 주어야 하며, 그는 package.json 파일에 다음과 같이 지정해 주어야 node 엔진이 해당 파일을 찾아서 실행이 가능하다.</p>
<p>package.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_moduleAliases"</span>: &#123;</span><br><span class="line">    <span class="attr">"@domain"</span>: <span class="string">"dist/domain"</span>,</span><br><span class="line">    <span class="attr">"@infra"</span>: <span class="string">"dist/infra"</span>,</span><br><span class="line">    <span class="attr">"@util"</span>: <span class="string">"dist/util"</span>,</span><br><span class="line">    <span class="attr">"@common"</span>: <span class="string">"dist/common"</span>,</span><br><span class="line">    <span class="attr">"@interfaces"</span>: <span class="string">"dist/interfaces"</span>,</span><br><span class="line">    <span class="attr">"@utils"</span>: <span class="string">"dist/utils"</span>,</span><br><span class="line">    <span class="attr">"@api"</span>: <span class="string">"dist/api"</span>,</span><br><span class="line">    <span class="attr">"@root"</span>: <span class="string">"dist"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Paths 뿐만 아니라 컴파일 시에 타겟 언어를 지정하고, 모듈관리, 소스맵 등의 다양한 옵션을 설정해 준다.</p>
<h2><span id="how-to-manage-environment-variables">How to manage environment variables</span></h2><p>서버를 운용함에 있어 개발 환경과 실제 운영서버에 따라 달라지는 다양한 환경변수들을 관리하는 것은 보안 및 시스템의 관리 측면에서 매우 중요하다.</p>
<p>본 프로젝트에서는 docker container 기술을 사용하여 운영서버를 배포하며, 개발 서버의 경우 로컬 머신을 사용한다.</p>
<p>여기서 운영서버의 경우 docker image 를 생성하는 시점에서 사용되는 <code>Dockerfile</code> 에 운영시에 사용되는 <code>environment variable</code> 을 저장</p>
<p>서버를 여러 배포환경에서 배포하기 위해 <code>dotenv</code> 라이브러리를 사용하여 <code>.env</code> 파일 내의 환경 변수를 프로세스 환경변수로 사용할 수 있다.</p>
<p>여기서 만약 <code>.env</code> 파일 내의 변수가 기존의 환경 변수와 충돌이 난다면 <code>.env</code> 파일에서 설정한 변수는 무시된다.</p>

                        
    </div>
    
            
</article>



        
    
        <article class="article content gallery" itemscope="" itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2018/01/14/nodejs-jwt-로그인-구현하기/" itemprop="url">
                node.js에서 jwt 로그인 구현하기
            </a>
            
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2018-01-14T05:45:08.000Z" itemprop="datePublished">
                a year ago
            </time>
        </span>
        
                
                    <span class="column is-narrow">
                        
                            
                                4 minutes read (About 586 words)
                    </span>
                    
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
        
                    <!-- toc -->
<ul>
<li><a href="#기본-개념">기본 개념</a><ul>
<li><a href="#jwt란">JWT란?</a></li>
<li><a href="#토큰-데이터의-구조">토큰 데이터의 구조</a></li>
</ul>
</li>
<li><a href="#준비사항">준비사항</a><ul>
<li><a href="#work-flow">Work Flow</a></li>
</ul>
</li>
<li><a href="#process">Process</a><ul>
<li><a href="#모듈-불러오기">모듈 불러오기</a></li>
<li><a href="#jasonwebtoken으로-토큰-발급하기">jasonwebtoken으로 토큰 발급하기</a></li>
<li><a href="#토큰-복호화-하기">토큰 복호화 하기</a></li>
</ul>
</li>
<li><a href="#참조">참조</a></li>
</ul>
<!-- tocstop -->
<h1><span id="기본-개념">기본 개념</span></h1><h3><span id="jwt란">JWT란?</span></h3><p>Jason Web Token</p>
<h3><span id="토큰-데이터의-구조">토큰 데이터의 구조</span></h3><p>실제 토큰=&gt;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0MTIzMTIzNTQzNTM0NTY3ODkwIiwibmFtZSI6IkpvaDM0NTM0NTM0NW4gRG9lIiwiYWRtaW4iOnRydWV9.gUpPTlD6M3F264lbRyXa6lat7t1tqoP3MHOwFX1qies</span><br></pre></td></tr></table></figure></p>
<p>각 부분은 .를 기준으로 3 파트로 나뉜다.</p>
<p>첫번째 파트 =&gt; 서명키 생성 방식에 대한 정보 (header)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;:&quot;HS256&quot;,</span><br><span class="line">  &quot;type&quot;:&quot;JWT&quot;</span><br><span class="line">&#125;</span><br><span class="line">=&gt; eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span><br></pre></td></tr></table></figure></p>
<p>두번째 파트 =&gt; 실제 데이터 정보 (payload)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;sub&quot;: &quot;1234123123543534567890&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;Joh345345345n Doe&quot;,</span><br><span class="line">  &quot;admin&quot;: true</span><br><span class="line">&#125;  </span><br><span class="line">=&gt; eyJzdWIiOiIxMjM0MTIzMTIzNTQzNTM0NTY3ODkwIiwibmFtZSI6IkpvaDM0NTM0NTM0NW4gRG9lIiwiYWRtaW4iOnRydWV9</span><br></pre></td></tr></table></figure></p>
<p>세번째 파트 =&gt; 데이터에 대한 무결성 / 변조 방지를 위한 HMAC<br>HMACSHA256(base64UrlEncode(header) + “.” +base64UrlEncode(payload),ServerkeyData)<br>=&gt; gUpPTlD6M3F264lbRyXa6lat7t1tqoP3MHOwFX1qies</p>
<h1><span id="준비사항">준비사항</span></h1><ol>
<li>jsonwebtoken 설치<br><code>npm install jsonwebtoken</code></li>
</ol>
<h2><span id="work-flow">Work Flow</span></h2><ol>
<li>회원가입 요청 =&gt; 서버에 id와 password 전달</li>
<li>서버에서 받은 email을 토대로 중복여부 판별</li>
<li>중복되지 않았다면 db에 jwt토큰을 복호화 하기 위한 secret key를 저장(random generate)</li>
<li>위의 secret key를 db에 저장</li>
<li>사용자가 로그인 시도하면 해당 secret key를 검색하여 토큰을 복호화하여 전달한 토큰과 일치하는지 확인하여 토큰을 전달한다.</li>
<li>받은 토큰을 사용자는 로컬에 저장한다.</li>
</ol>
<h1><span id="process">Process</span></h1><h3><span id="모듈-불러오기">모듈 불러오기</span></h3><p><code>const jwt = require(&#39;jsonwebtoken&#39;)</code></p>
<h3><span id="jasonwebtoken으로-토큰-발급하기">jasonwebtoken으로 토큰 발급하기</span></h3><p><code>jwt.sign(payload, secret, options, [callback])</code><br>만약에 callback 이 전달되면 비동기적으로 작동하며, 콜백함수의 파라미터는 (err, token) 입니다.<br>전달되지 않을시엔 동기적으로 작동하며, JWT 를 문자열 형태로 리턴합니다.<br>payload 는  객체, buffer, 혹은 문자열형태로 전달 될 수있습니다.<br>secret 은 서명을 만들 때 사용되는 알고리즘에서 사용되는 문자열 혹은 buffer 형태의 값 입니다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var token = jwt.sign(payLoad,tokenKey,&#123;</span><br><span class="line">    algorithm : &apos;HS256&apos;, //&quot;HS256&quot;, &quot;HS384&quot;, &quot;HS512&quot;, &quot;RS256&quot;, &quot;RS384&quot;, &quot;RS512&quot; default SHA256</span><br><span class="line">    expiresInMinutes : 1440 //expires in 24 hours</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h3><span id="토큰-복호화-하기">토큰 복호화 하기</span></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var jwt      = require(&apos;jsonwebtoken&apos;);</span><br><span class="line">var tokenKey = &quot;TEST_KEY11&quot;; //토큰키 서버에서 보관 중요</span><br><span class="line">var token = &apos;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1aWQiOjE0NTU0LCJpYXQiOjE0MzUxMzA4NzMsImV4cCI6MTQzNTIxNzI3M30.EWNUjnktCWxlqAAZW2bb0KCj5ftVjpDBocgv2OiypqM&apos;;</span><br><span class="line"></span><br><span class="line">//비동기처리</span><br><span class="line">jwt.verify(token,tokenKey,function(err,decoded)&#123;</span><br><span class="line">    console.log(&quot;sync : &quot;, decoded);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">//동기처리</span><br><span class="line">try &#123;</span><br><span class="line">    var decoded = jwt.verify(token,tokenKey);</span><br><span class="line">    console.log(&quot;async : &quot;, decoded);</span><br><span class="line">&#125; catch(err)&#123;</span><br><span class="line">    console.log(err);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1><span id="참조">참조</span></h1><p>nodejs에서 jwt를 사용하기 위한 npm package를 설치하고 이용한다.</p>
<p><a href="https://www.npmjs.com/package/jsonwebtoken" target="_blank" rel="noopener">NPM 참고자료</a></p>
<hr>

                        
    </div>
    
            
</article>



        
    
        <article class="article content gallery" itemscope="" itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2017/12/08/Nodejs-Google-Api를-활용한-push-서버-구축/" itemprop="url">
                Nodejs Google Api를 활용한 push 서버 구축
            </a>
            
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2017-12-08T07:12:04.000Z" itemprop="datePublished">
                2 years ago
            </time>
        </span>
        
                
                    <span class="column is-narrow">
                        
                            
                                a few seconds read (About 20 words)
                    </span>
                    
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
        
                    <h2><span id="code-flow">Code Flow</span></h2><p><code>NPM install fcm-node</code></p>
<ol start="2">
<li>Usage<br><a href="https://www.npmjs.com/package/fcm-node" target="_blank" rel="noopener">Api 서버 만들기</a></li>
</ol>

                        
    </div>
    
            
</article>



        
    
        <article class="article content gallery" itemscope="" itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2017/12/08/nodejs에서-thumbnail-만들기/" itemprop="url">
                nodejs thumbnail 만들기
            </a>
            
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2017-12-08T02:26:11.000Z" itemprop="datePublished">
                2 years ago
            </time>
        </span>
        
                
                    <span class="column is-narrow">
                        
                            
                                2 minutes read (About 229 words)
                    </span>
                    
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
        
                    <!-- toc -->
<ul>
<li><a href="#개요">개요</a></li>
<li><a href="#설치">설치</a></li>
<li><a href="#서버-코드">서버 코드</a></li>
<li><a href="#default-options">default options</a></li>
<li><a href="#referencehttpswwwnpmjscompackagenode-thumbnail">reference</a></li>
</ul>
<!-- tocstop -->
<h2><span id="개요">개요</span></h2><p>먼저 multiparty로 req를 받아 파일과 필드값으로 나누어 준 뒤에 노드 썸네일을 통해 변환을 해 준다.</p>
<h2><span id="설치">설치</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install node-thumbnail</span><br></pre></td></tr></table></figure>
<h2><span id="서버-코드">서버 코드</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">var multiparty = require(&apos;multiparty&apos;);</span><br><span class="line">var thumb = require(&apos;node-thumbnail&apos;).thumb;</span><br><span class="line"></span><br><span class="line">router.post(&apos;/thumbnail&apos;,function(req,res)&#123;</span><br><span class="line">  console.log(&quot;썸네일 변경!&quot;);</span><br><span class="line">  var form = new multiparty.Form();</span><br><span class="line">  form.parse(req,function(err,fields, files)&#123;</span><br><span class="line">    if(err)&#123;</span><br><span class="line">      console.log(err);</span><br><span class="line">    &#125;</span><br><span class="line">    Object.keys(fields).forEach(function(name) &#123;</span><br><span class="line">      console.log(&apos;got field named &apos; + name);</span><br><span class="line">    &#125;);</span><br><span class="line">    console.log(&quot;files:&quot;, files);</span><br><span class="line"></span><br><span class="line">    var fileName=fields.fileName[0];</span><br><span class="line">    var oldPath = files.imageFile[0].path;</span><br><span class="line">    console.log(fileName);</span><br><span class="line">    // 서버에서 돌리는 부분</span><br><span class="line">    var newPath = &apos;/root/imageServer/public/images&apos;;</span><br><span class="line">    </span><br><span class="line">    thumb(&#123;</span><br><span class="line">      basename:fileName.split(&quot;.&quot;)[0],</span><br><span class="line">      suffix:&apos;&apos;,</span><br><span class="line">      source: oldPath,</span><br><span class="line">      destination: newPath,</span><br><span class="line">      width: 300</span><br><span class="line">    &#125;).then(function() &#123;</span><br><span class="line">      console.log(&apos;Success&apos;);</span><br><span class="line">      res.sendStatus(200)</span><br><span class="line">    &#125;).catch(function(e) &#123;</span><br><span class="line">      console.log(&apos;Error&apos;, e.toString());</span><br><span class="line">      res.sendStatus(500);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2><span id="default-options">default options</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">defaults = &#123;</span><br><span class="line">  prefix: &apos;&apos;,</span><br><span class="line">  suffix: &apos;_thumb&apos;,</span><br><span class="line">  digest: false,</span><br><span class="line">  hashingType: &apos;sha1&apos;, // &apos;sha1&apos;, &apos;md5&apos;, &apos;sha256&apos;, &apos;sha512&apos;</span><br><span class="line">  width: 800,</span><br><span class="line">  concurrency: &lt;num of cpus&gt;,</span><br><span class="line">  quiet: false, // if set to &apos;true&apos;, console.log status messages will be supressed</span><br><span class="line">  overwrite: false,</span><br><span class="line">  basename: undefined, // basename of the thumbnail. If unset, the name of the source file is used as basename.</span><br><span class="line">  ignore: false, // Ignore unsupported files in &quot;dest&quot;</span><br><span class="line">  logger: function(message) &#123;</span><br><span class="line">    console.log(message);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2><span id="reference"></span></h2>
                        
    </div>
    
            
</article>



        
    
        <article class="article content gallery" itemscope="" itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="/2017/11/29/angular와-nodejs를-활용한-socket-io-사용하기/" itemprop="url">
                angular와 nodejs를 활용한 socket.io 사용하기
            </a>
            
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2017-11-29T13:57:23.000Z" itemprop="datePublished">
                2 years ago
            </time>
        </span>
        
                
                    <span class="column is-narrow">
                        
                            
                                2 minutes read (About 330 words)
                    </span>
                    
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
        
                    <!-- toc -->
<ul>
<li><a href="#serverjs-작성">server.js 작성</a></li>
<li><a href="#클라이언트에서-socketio-설치-및-임포트">클라이언트에서 socket.io 설치 및 임포트</a></li>
<li><a href="#angular-service">angular service</a></li>
<li><a href="#angular-component">angular component</a></li>
</ul>
<!-- tocstop -->
<h2><span id="serverjs-작성">server.js 작성</span></h2><p>express 에서 socket.io를 실행하기 위해</p>
<p>express.io를 설치한다.</p>
<p>노드 http 서버와 결합시킬 socket.io에 http를 전달하여 initialize한다.</p>
<p>connection 이벤트가 발생하면 특정 동작을 한다.</p>
<p>io.emit을 통해 데이터를 전달한다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var io = require(&apos;socket.io&apos;).listen(server);</span><br><span class="line"></span><br><span class="line">io.on(&apos;connection&apos;, (socket) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    console.log(&apos;user connected&apos;);</span><br><span class="line"></span><br><span class="line">    socket.on(&apos;disconnect&apos;, function() &#123;</span><br><span class="line">        console.log(&apos;user disconnected&apos;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    socket.on(&apos;add-message&apos;, (message) =&gt; &#123;</span><br><span class="line">        io.emit(&apos;message&apos;, &#123; type: &apos;new-message&apos;, text: message &#125;);</span><br><span class="line">        // Function above that stores the message in the database</span><br><span class="line">        databaseStore(message)</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h2><span id="클라이언트에서-socketio-설치-및-임포트">클라이언트에서 socket.io 설치 및 임포트</span></h2><p>소켓 io를 라우터에 전달한다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">npm i socket.io-client --save</span><br><span class="line">npm install socket.io --save</span><br><span class="line"></span><br><span class="line">const server = http.createServer(app);</span><br><span class="line">var io = require(&apos;socket.io&apos;).listen(server);</span><br><span class="line">const all = require(&apos;./server/routes/all&apos;)(mysql, conn, express, io);</span><br></pre></td></tr></table></figure></p>
<h2><span id="angular-service">angular service</span></h2><p>io()는 socket을 반환한다.</p>
<p>socket.emit을 통해 이벤트를 발생시킨다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import &#123; Injectable &#125; from &apos;@angular/core&apos;;</span><br><span class="line">import &#123; Subject &#125; from &apos;rxjs/Subject&apos;;</span><br><span class="line">import &#123; Observable &#125; from &apos;rxjs/Observable&apos;;</span><br><span class="line">import * as io from &apos;socket.io-client&apos;;</span><br><span class="line"></span><br><span class="line">@Injectable()</span><br><span class="line">export class ChatService &#123;</span><br><span class="line">  private url = &apos;http://localhost:5000&apos;;</span><br><span class="line">  private socket;</span><br><span class="line"></span><br><span class="line">  sendMessage(message)&#123;</span><br><span class="line">    this.socket.emit(&apos;add-message&apos;, message);    </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  getMessages() &#123;</span><br><span class="line">    let observable = new Observable(observer =&gt; &#123;</span><br><span class="line">      this.socket = io(this.url);</span><br><span class="line">      this.socket.on(&apos;message&apos;, (data) =&gt; &#123;</span><br><span class="line">        observer.next(data);    </span><br><span class="line">      &#125;);</span><br><span class="line">      return () =&gt; &#123;</span><br><span class="line">        this.socket.disconnect();</span><br><span class="line">      &#125;;  </span><br><span class="line">    &#125;)     </span><br><span class="line">    return observable;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2><span id="angular-component">angular component</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">messages = [];</span><br><span class="line">connection;</span><br><span class="line">message;</span><br><span class="line"></span><br><span class="line">sendMessage()&#123;</span><br><span class="line">  this.chatService.sendMessage(this.message);</span><br><span class="line">  this.message = &apos;&apos;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ngOnInit() &#123;</span><br><span class="line">  this.connection = this.chatService.getMessages().subscribe(message =&gt; &#123;</span><br><span class="line">    this.messages.push(message);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ngOnDestroy() &#123;</span><br><span class="line">  this.connection.unsubscribe();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://stackoverflow.com/questions/16981396/get-http-localhost3000-socket-io-socket-io-js-404-not-found" target="_blank" rel="noopener">참조</a><br><a href="https://stackoverflow.com/questions/29334800/express-js-4-and-sockets-with-express-router" target="_blank" rel="noopener">use with router</a></p>

                        
    </div>
    
            
</article>



        
    
    
        
<nav class="pagination is-centered is-rounded" role="navigation" aria-label="pagination">
    <div class="pagination-previous is-invisible is-hidden-mobile">
        <a href="/tags/nodejs/page/0/">Prev</a>
    </div>
    <div class="pagination-next">
        <a href="/tags/nodejs/page/2/">Next</a>
    </div>
    <ul class="pagination-list is-hidden-mobile">
        
        <li><a class="pagination-link is-current" href="/tags/nodejs/">1</a></li>
        
        <li><a class="pagination-link" href="/tags/nodejs/page/2/">2</a></li>
        
    </ul>
</nav>
    
    </div>
</section>

            <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2019 Jake.Lee 이남훈&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow has-text-black" href="https://github.com/frontalnh">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
        </div>
    </div>
</footer>
                <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        //plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {matchFontHeight: false},
        SVG: {matchFontHeight: false},
        CommonHTML: {matchFontHeight: false}
    });
</script>

    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110077250-2"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-110077250-2');
</script>


    


<script src="/js/script.js"></script>

                    
                        <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js"></script>
                            
</body>

</html>